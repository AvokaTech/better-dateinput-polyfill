/**
 * better-dateinput-polyfill: input[type=date] polyfill for better-dom
 * @version 2.0.0-beta.2 Sun, 10 Apr 2016 12:59:11 GMT
 * @link https://github.com/chemerisuk/better-dateinput-polyfill
 * @copyright 2016 Maksim Chemerisuk
 * @license MIT
 */
!function(t,e,a,n,i,r,o,s,d){"use strict";var l=t.get("documentElement"),c=function(t,e){return"en-US"===l.lang?t:e},h=function(t){return t.toISOString().split("T")[0]},u=t.create(t.emmet("div."+e+"-calendar>(p."+e+"-calendar-header>a[unselectable=on]*2+time[is=local-time data-format='MMMM yyyy' aria-hidden=true unselectable=on]."+e+"-calendar-caption)")),b=t.create(t.emmet("table[aria-hidden=true]."+e+"-calendar-days>(thead>(tr>th[unselectable=on]*7>time[is=local-time data-format=E]))+(tbody."+e+"-calendar-body*2>tr*6>td*7)")),f=t.create(t.emmet("table[aria-hidden=true]."+e+"-calendar-months>tbody>tr*3>td*4>time[is=local-time data-format=MMM])")),m=t.create(t.emmet("time[is=local-time aria-hidden=true]."+e+"-value")),p=function(t){return["min","max"].map(function(e){return new Date(t.get(e)||"")})};f.findAll("time").forEach(function(t,e){t.set("datetime",new Date(2001,e,9).toISOString())}),b.findAll("time").forEach(function(t,e){t.set("datetime",new Date(c(2001,2002),0,e).toISOString())}),t.extend("input[type=date]",{constructor:function(){if(this._isNative())return!1;var t=u.clone(!0),a=m.clone(!0);this.on(["focus","click"],this._focusPicker.bind(this,t)).on("blur",this._blurPicker.bind(this,t)).on("change",this._syncDateValue.bind(this,a)).before(t.hide(),a),a.set("data-format",this.get("data-format")||"E, dd MMM yyyy").css(this.css(["color","width","font","padding","text-align","border-width","box-sizing","border-style"])).on("click",this._clickLabel.bind(this));var n=b.clone(!0),i=n.findAll("."+e+"-calendar-body"),r=f.clone(!0),o=t.find("."+e+"-calendar-caption"),s=this._changeValue.bind(this,o,r,i,t);t.append(n),i[1].hide().remove(),o.on("click",this._clickPickerCaption.bind(this,t,r,n,o,s)),this.on("keydown",["which"],this._keydownPicker.bind(this,t,r,o)).watch("value",s),this.closest("form").on("reset",this._resetForm.bind(this)),s(this.get("defaultValue")),t.on("mousedown",["target"],this._clickPicker.bind(this,t,r)).watch("aria-hidden",this._changePickerVisibility.bind(this,t,r,o)).css("z-index",1+(0|this.css("z-index"))).hide(),this.css("color",document.addEventListener?"transparent":this.css("background-color")),this.matches(":focus")&&t.show()},_isNative:function(){var t=this.get("data-polyfill"),e="orientation"in window?"mobile":"desktop";if("none"===t)return!0;if(!t||t===e&&"all"!==t){if("date"===this[0].type)return!0;var a=this.value("_").value();return"_"!==a}return this.set("type","text"),!1},_changeValue:function(t,a,n,i,r,o){if(n.every(function(t){return i.contains(t)}))return!1;var s,d,l,h;r=new Date(r),r.getTime()||(r=new Date),d=r.getUTCMonth(),l=r.getUTCDate(),s=r.getUTCFullYear(),t.set("datetime",new Date(s,d).toISOString()),h=new Date(Date.UTC(s,d,1));var u=p(this);if(i.contains(a))a.findAll("td").forEach(function(t,a){h.setUTCMonth(a);var n=d-h.getUTCMonth(),i=e+"-calendar-";h<u[0]||h>u[1]?i+="out":n?i="":i+="today",t.set("class",i)});else{h.setUTCDate(h.getUTCDate()-h.getUTCDay()-c(1,0)),o=new Date(o);var b=r.getUTCMonth()-o.getUTCMonth()+100*(r.getUTCFullYear()-o.getUTCFullYear()),f=n[i.contains(n[0])?0:1],m=b?n[n[0]===f?1:0]:f;m.findAll("td").forEach(function(t){h.setUTCDate(h.getUTCDate()+1);var a=d-h.getUTCMonth(),n=e+"-calendar-";s!==h.getUTCFullYear()&&(a*=-1),h<u[0]||h>u[1]?n+="out":a>0?n+="past":0>a?n+="future":l===h.getUTCDate()?n+="today":n="",t.set("class",n).data("ts",h.getTime()).value(h.getUTCDate())}),b&&(f[b>0?"after":"before"](m),f.hide(function(){f.remove()}),m.show())}this.fire("change")},_syncDateValue:function(t){t.set("datetime",this.value())},_clickPicker:function(t,e,a){var n;if(a.matches("a")){n=new Date(this.value()),n.getTime()||(n=new Date);var i=a.next("a")[0]?-1:1;t.contains(e)?n.setUTCFullYear(n.getUTCFullYear()+i):n.setUTCMonth(n.getUTCMonth()+i)}else e.contains(a)?(a=a.closest("time"),n=new Date(this.value()),n.setUTCMonth(new Date(a.get("datetime")).getUTCMonth()),t.hide()):a.matches("td")&&(n=a.data("ts"),n&&(n=new Date(n),t.hide()));if(null!=n){var r=p(this);n<r[0]?n=r[0]:n>r[1]&&(n=r[1]),this.value(h(n))}return!1},_keydownPicker:function(t,e,l,c){var u,b;if(t.matches(":hidden")&&c===i)return!0;if(c===a)t.toggle();else if(c===r||c===n||c===i)t.hide();else if(c===o||c===s)this.empty();else if(c===d)l.fire("click");else if(b=new Date(this.value()),b.getTime()||(b=new Date),74===c||40===c?u=7:75===c||38===c?u=-7:76===c||39===c?u=1:72!==c&&37!==c||(u=-1),u){var f=t.contains(e);!f||40!==c&&38!==c?!f||37!==c&&39!==c?b.setUTCDate(b.getUTCDate()+u):b.setUTCMonth(b.getUTCMonth()+(u>0?1:-1)):b.setUTCMonth(b.getUTCMonth()+(u>0?4:-4));var m=p(this);b<m[0]||b>m[1]||this.value(h(b))}return c===n},_blurPicker:function(t){t.hide()},_focusPicker:function(t){var e=this;if(this.get("readonly"))return!1;var a=this.offset(),n=t.offset(),i=a.height;l.clientHeight<a.bottom+n.height&&(i=-n.height),t.css("margin-top",i).show(),setTimeout(function(){var t=e[0];if("selectionStart"in t)t.selectionStart=0,t.selectionEnd=0;else{var a=t.createTextRange();a.moveStart("character",0),a.collapse(),a.moveEnd("character",0),a.select()}},0)},_clickPickerCaption:function(t,e,a,n,i){t.contains(e)?(e.remove(),t.append(a),n.set("data-format","MMMM yyyy")):(a.remove(),t.append(e),n.set("data-format","yyyy")),i(this.value())},_changePickerVisibility:function(t,e,a,n){"true"!==n&&t.contains(e)&&a.fire("click")},_clickLabel:function(){this.fire("focus")},_resetForm:function(){this.value(this.get("defaultValue"))}})}(window.DOM,"btr-dateinput",32,9,13,27,8,46,16),DOM.importStyles("@media screen",".btr-dateinput-value{position:absolute;display:inline-block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;border-style:none solid;border-color:transparent;pointer-events:none}.btr-dateinput-calendar{position:absolute;visibility:hidden;display:inline-block;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;color:#FFF;border-bottom:1px solid #CCC;overflow:hidden;border-radius:3px;-webkit-box-shadow:0 .25em .5em rgba(0,0,0,.2);box-shadow:0 .25em .5em rgba(0,0,0,.2);font-family:Helvetica Neue,Helvetica,Arial,sans-serif;text-align:center;opacity:1;-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0);-webkit-transform-origin:0 0;-ms-transform-origin:0 0;transform-origin:0 0;-webkit-transition:.1s ease-out;transition:.1s ease-out;width:17em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.btr-dateinput-calendar[aria-hidden=true]{opacity:0;-webkit-transform:skew(-10deg) scaleX(.75);-ms-transform:skew(-10deg) scaleX(.75);transform:skew(-10deg) scaleX(.75)}.btr-dateinput-calendar-header{position:relative;margin:0;height:2.5em;line-height:2.5em;font-weight:700;white-space:nowrap;background:#2da4d6;text-shadow:0 1px 0 #555;border-bottom:1px solid #207fb1}.btr-dateinput-calendar-header>a{width:2.5em;height:2.5em;position:absolute;left:0;top:0;color:inherit}.btr-dateinput-calendar-header>time{display:block}.btr-dateinput-calendar-header>a:before{content:'\\25C4'}.btr-dateinput-calendar-header>a:before{font-size:.85em}.btr-dateinput-calendar-header>a+a{left:auto;right:0}.btr-dateinput-calendar-header>a+a:before{content:'\\25BA'}.btr-dateinput-calendar-days,.btr-dateinput-calendar-months{width:100%;table-layout:fixed;border-spacing:0;border-collapse:collapse;color:#555;background:#FFF;border-radius:3px;border:1px solid #CCC;border-bottom:0}.btr-dateinput-calendar-days>thead{border-top:1px solid #EEE;border-bottom:1px solid #CCC;font-size:.75em;background:#DDD;font-weight:700;text-shadow:0 1px 0 #f3f3f3}.btr-dateinput-calendar-body{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0);-webkit-transition:-webkit-transform .1s linear;transition:-webkit-transform .1s linear;transition:transform .1s linear;transition:transform .1s linear,-webkit-transform .1s linear}.btr-dateinput-calendar-body[aria-hidden=true]{-webkit-transform:translateX(-100%);-ms-transform:translateX(-100%);transform:translateX(-100%)}.btr-dateinput-calendar-body+.btr-dateinput-calendar-body{position:absolute;bottom:0}.btr-dateinput-calendar-body+.btr-dateinput-calendar-body[aria-hidden=true]{-webkit-transform:translateX(100%);-ms-transform:translateX(100%);transform:translateX(100%)}.btr-dateinput-calendar td,.btr-dateinput-calendar th{width:2.5em;height:2.25em;line-height:2.25;padding:0;text-align:center}.btr-dateinput-calendar-months td{line-height:4;height:4em}.btr-dateinput-calendar-months time{display:block}.btr-dateinput-calendar-past,.btr-dateinput-calendar-future{color:#DDD}.btr-dateinput-calendar-out{color:#CCC;text-shadow:0 1px 0 #FFF}.btr-dateinput-calendar-today{color:#FFF;background-color:#2da4d6;text-shadow:0 1px 0 #555;font-weight:700}.btr-dateinput-calendar-out,.btr-dateinput-calendar td:hover{background-color:#f3f3f3;background-color:rgba(0,0,0,.05)}.btr-dateinput-calendar-header>a:hover,td.btr-dateinput-calendar-today:hover{background-color:#207fb1;text-decoration:none}.btr-dateinput-value+input::-moz-placeholder{color:initial}");